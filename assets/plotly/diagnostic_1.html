<!DOCTYPE html>
<html>

<head>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    .graph-container {
      padding: 1rem;
    }

    .sankey-graph {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <div class="graph-container">
    <div id="sankey-graph"></div>
  </div>
  <script>
    const groups = [{"layout":{"arrangement":"fixed","title":"Group 1 - 20 patient(s) filtered due to lack of variation","font":{"size":12},"height":400},"data":{"type":"sankey","orientation":"h","node":{"pad":15,"thickness":30,"line":{"color":"black","width":0.5},"x":[0,0,100,200,300,0,0,0,100,0,0,0,0,0,0,0,100,200,0,100,0,0,100,100,200,0,100,0,100,0,100,0,100,200,0,0,100,0,0,100,0,0,0,100,200,300,400,500,600,700,0,0,100,200,0,0,0,100],"label":["leuprolide acetate","pemetrexed","carboplatin","erlotinib","crizotinib","carboplatin,<br>etop...","cisplatin,<br>etopos...","carboplatin,<br>peme...","gemcitabine","erlotinib","carboplatin,<br>peme...","fluorouracil","cisplatin,<br>pemetr...","crizotinib","erlotinib","osimertinib","imiquimod","cisplatin,<br>etopos...","carboplatin,<br>pacl...","gemcitabine","nivolumab","gemcitabine,<br>peme...","nivolumab","hydroxyurea","rituximab","cyclophosphamide","cisplatin,<br>pemetr...","pembrolizumab","pembrolizumab","carboplatin","docetaxel","tamoxifen","nivolumab","letrozole","carboplatin,<br>pacl...","pembrolizumab","temozolomide","methotrexate,<br>cyt...","abemaciclib","bevacizumab,<br>peme...","pemetrexed","pemetrexed"],"color":["#52DAD0","#3F1C9D","#03D2F5","#64BE82","#F1CA43","#AC230D","#8B2EB9","#CF51E6","#1AAC60","#64BE82","#CF51E6","#B4DF3F","#D1BBBA","#F1CA43","#64BE82","#0AD7DD","#D5AE22","#8B2EB9","#9282AC","#1AAC60","#7515F1","#03151B","#7515F1","#19AD6A","#9B14C5","#A3DBBA","#D1BBBA","#3E44EF","#3E44EF","#03D2F5","#50BF85","#91BF8F","#7515F1","#E62D06","#9282AC","#3E44EF","#688B68","#EBDB30","#C76FA0","#1F35FC","#3F1C9D","#3F1C9D"],"customdata":[{"incoming":0,"outgoing":1,"fullLabel":"leuprolide acetate"},{"incoming":0,"outgoing":1,"fullLabel":"pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"carboplatin"},{"incoming":1,"outgoing":1,"fullLabel":"erlotinib"},{"incoming":1,"outgoing":1,"fullLabel":"crizotinib"},{"incoming":0,"outgoing":2,"fullLabel":"carboplatin,<br>etoposide"},{"incoming":0,"outgoing":4,"fullLabel":"cisplatin,<br>etoposide"},{"incoming":1,"outgoing":1,"fullLabel":"carboplatin,<br>pemetrexed"},{"incoming":0,"outgoing":1,"fullLabel":"gemcitabine"},{"incoming":0,"outgoing":1,"fullLabel":"erlotinib"},{"incoming":0,"outgoing":3,"fullLabel":"carboplatin,<br>pemetrexed"},{"incoming":0,"outgoing":2,"fullLabel":"fluorouracil"},{"incoming":0,"outgoing":3,"fullLabel":"cisplatin,<br>pemetrexed"},{"incoming":0,"outgoing":1,"fullLabel":"crizotinib"},{"incoming":1,"outgoing":1,"fullLabel":"erlotinib"},{"incoming":2,"outgoing":1,"fullLabel":"osimertinib"},{"incoming":0,"outgoing":1,"fullLabel":"imiquimod"},{"incoming":2,"outgoing":2,"fullLabel":"cisplatin,<br>etoposide"},{"incoming":0,"outgoing":4,"fullLabel":"carboplatin,<br>paclitaxel"},{"incoming":2,"outgoing":2,"fullLabel":"gemcitabine"},{"incoming":1,"outgoing":1,"fullLabel":"nivolumab"},{"incoming":1,"outgoing":1,"fullLabel":"gemcitabine,<br>pemetrexed"},{"incoming":6,"outgoing":3,"fullLabel":"nivolumab"},{"incoming":0,"outgoing":1,"fullLabel":"hydroxyurea"},{"incoming":0,"outgoing":1,"fullLabel":"rituximab"},{"incoming":1,"outgoing":1,"fullLabel":"cyclophosphamide"},{"incoming":1,"outgoing":1,"fullLabel":"cisplatin,<br>pemetrexed"},{"incoming":0,"outgoing":1,"fullLabel":"pembrolizumab"},{"incoming":1,"outgoing":1,"fullLabel":"pembrolizumab"},{"incoming":0,"outgoing":1,"fullLabel":"carboplatin"},{"incoming":1,"outgoing":1,"fullLabel":"docetaxel"},{"incoming":0,"outgoing":1,"fullLabel":"tamoxifen"},{"incoming":0,"outgoing":1,"fullLabel":"nivolumab"},{"incoming":0,"outgoing":1,"fullLabel":"letrozole"},{"incoming":1,"outgoing":1,"fullLabel":"carboplatin,<br>paclitaxel"},{"incoming":1,"outgoing":1,"fullLabel":"pembrolizumab"},{"incoming":1,"outgoing":1,"fullLabel":"temozolomide"},{"incoming":1,"outgoing":1,"fullLabel":"methotrexate,<br>cytarabine"},{"incoming":1,"outgoing":1,"fullLabel":"abemaciclib"},{"incoming":1,"outgoing":1,"fullLabel":"bevacizumab,<br>pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"pemetrexed"}],"hovertemplate":"Node: %{customdata.fullLabel}<br>Patients: %{value}<br>Incoming Links: %{customdata.incoming}<br>Outgoing Links: %{customdata.outgoing}<extra></extra>"},"link":{"color":["rgba(230,230,230,1)","rgba(195,195,195,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(195,195,195,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(73,73,73,1)","rgba(128,128,128,1)","rgba(55,55,55,1)","rgba(195,195,195,1)","rgba(128,128,128,1)","rgba(195,195,195,1)","rgba(195,195,195,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(195,195,195,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(128,128,128,1)","rgba(230,230,230,1)"],"source":[0,1,2,3,4,5,6,6,7,8,9,10,11,12,13,6,14,15,16,17,18,18,19,19,20,18,21,10,22,23,17,24,25,26,27,10,28,5,29,30,31,32,33,22,34,35,36,37,38,39,12,6,22,40,12,18,11,41],"target":[-1,2,3,4,-1,-1,-1,7,-1,-1,-1,-1,-1,-1,-1,14,15,-1,17,-1,-1,19,-1,20,-1,21,-1,22,-1,17,15,25,26,-1,-1,28,-1,22,30,-1,-1,-1,22,34,35,36,37,38,39,-1,22,22,40,-1,19,22,41,-1],"value":[1,1,1,1,1,1,2,2,2,1,2,1,1,3,1,1,1,2,1,1,3,2,2,1,1,1,1,3,5,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1],"label":["Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 month, 1 day<br>Duration to next treatment minimum: 1 month, 1 day<br>Duration to next treatment maximum: 1 month, 1 day<extra></extra>","Duration to next treatment median: 1 year, 1 month, 29 days<br>Duration to next treatment minimum: 1 year, 1 month, 29 days<br>Duration to next treatment maximum: 1 year, 1 month, 29 days<extra></extra>","Duration to next treatment median: 2 years, 5 months, 4 days<br>Duration to next treatment minimum: 2 years, 5 months, 4 days<br>Duration to next treatment maximum: 2 years, 5 months, 4 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 1 year, 7 months, 5 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 year, 3 months, 2 days<br>Duration to next treatment minimum: 1 year, 3 months, 2 days<br>Duration to next treatment maximum: 1 year, 3 months, 2 days<extra></extra>","Duration to next treatment median: 10 months, 4 days<br>Duration to next treatment minimum: 10 months, 4 days<br>Duration to next treatment maximum: 10 months, 4 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 year, 1 month, 2 days<br>Duration to next treatment minimum: 1 year, 1 month, 2 days<br>Duration to next treatment maximum: 1 year, 1 month, 2 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 2 years, 5 months, 4 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 5 months, <br>Duration to next treatment minimum: 5 months, <br>Duration to next treatment maximum: 5 months, <extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 3 months, 1 day<br>Duration to next treatment minimum: 3 months, 1 day<br>Duration to next treatment maximum: 3 months, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 month, 1 day<br>Duration to next treatment minimum: 4 months, 2 days<br>Duration to next treatment maximum: 6 months, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 5 months, 3 days<br>Duration to next treatment minimum: 5 months, 3 days<br>Duration to next treatment maximum: 5 months, 3 days<extra></extra>","Duration to next treatment median: 1 year, 2 months, 1 day<br>Duration to next treatment minimum: 1 year, 2 months, 1 day<br>Duration to next treatment maximum: 1 year, 2 months, 1 day<extra></extra>","Duration to next treatment median: 9 months, 3 days<br>Duration to next treatment minimum: 9 months, 3 days<br>Duration to next treatment maximum: 9 months, 3 days<extra></extra>","Duration to next treatment median: 8 months, 5 days<br>Duration to next treatment minimum: 8 months, 5 days<br>Duration to next treatment maximum: 8 months, 5 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 month, <br>Duration to next treatment minimum: 1 month, <br>Duration to next treatment maximum: 1 month, <extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 3 months, 2 days<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 3 months, 2 days<extra></extra>","Duration to next treatment median: 11 months, 7 days<br>Duration to next treatment minimum: 11 months, 7 days<br>Duration to next treatment maximum: 11 months, 7 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 6 months, 2 days<br>Duration to next treatment minimum: 6 months, 2 days<br>Duration to next treatment maximum: 6 months, 2 days<extra></extra>","Duration to next treatment median: 4 months, 2 days<br>Duration to next treatment minimum: 4 months, 2 days<br>Duration to next treatment maximum: 4 months, 2 days<extra></extra>","Duration to next treatment median: 11 months, 5 days<br>Duration to next treatment minimum: 11 months, 5 days<br>Duration to next treatment maximum: 11 months, 5 days<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 2 months, 1 day<br>Duration to next treatment maximum: 2 months, 1 day<extra></extra>","Duration to next treatment median: 3 months, 2 days<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 3 months, 2 days<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 2 months, 1 day<br>Duration to next treatment maximum: 2 months, 1 day<extra></extra>","Duration to next treatment median: 1 month, 29 days<br>Duration to next treatment minimum: 1 month, 29 days<br>Duration to next treatment maximum: 1 month, 29 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 11 months, 4 days<br>Duration to next treatment minimum: 11 months, 4 days<br>Duration to next treatment maximum: 11 months, 4 days<extra></extra>","Duration to next treatment median: 10 months, 6 days<br>Duration to next treatment minimum: 10 months, 6 days<br>Duration to next treatment maximum: 10 months, 6 days<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 1 month, 29 days<br>Duration to next treatment maximum: 3 months, 2 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 years, 28 days<br>Duration to next treatment minimum: 2 years, 28 days<br>Duration to next treatment maximum: 2 years, 28 days<extra></extra>","Duration to next treatment median: 7 months, 3 days<br>Duration to next treatment minimum: 7 months, 3 days<br>Duration to next treatment maximum: 7 months, 3 days<extra></extra>","Duration to next treatment median: 3 months, 2 days<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 3 months, 2 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>"],"hovertemplate":"%{label}<extra></extra>"}}}]

    groups.forEach((group, i) => {
      if (!group?.data || !group?.layout) {
        return
      }
      const data = group.data
      const layout = group.layout
      
      if (data.node.customdata.length <= 1) {
        layout.height = 200
      } else {
        layout.height = 600
      }

      const id = `PlotlyChart-${i}`
      
      // Create new div to mount chart to
      const graphDiv = document.createElement('div')
      graphDiv.id = id
      const parent = document.getElementById('sankey-graph')
      parent.appendChild(graphDiv)

      Plotly.react(id, [data], layout, { responsive: true, displayModeBar: false }).then(() => {
        // After rendering, manually replace <br> in labels with <tspan> because they aren't created
        // by Plotly when displayed this way.
        const svgTextNodes = graphDiv.querySelectorAll('.node-label')
        svgTextNodes.forEach((textNode) => {
          const originalText = textNode.textContent

          if (originalText.includes('<br>')) {
            const lines = originalText.split('<br>')
            textNode.innerHTML = ''

            lines.forEach((line, index) => {
              // Have to use createElementNS to create a tspan. Can't use createElement.
              // https://www.motiontricks.com/creating-dynamic-svg-elements-with-javascript/
              const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan')
              // These are the attributes Plotly adds to its tspans when given <br> Datma.Why
              tspan.setAttribute('x', '0')
              tspan.setAttribute('dy', index === 0 ? '0em' : '1.3em')
              tspan.textContent = line
              textNode.appendChild(tspan)
            })
          }
        })
      })
    })
  </script>
</body>
</html>