<!DOCTYPE html>
<html>

<head>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    .graph-container {
      padding: 1rem;
    }

    .sankey-graph {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <div class="graph-container">
    <div id="sankey-graph"></div>
  </div>
  <script>
    const groups = [{"layout":{"arrangement":"fixed","title":"Group 2 - 20 patient(s) filtered due to lack of variation","font":{"size":12},"height":400},"data":{"type":"sankey","orientation":"h","node":{"pad":15,"thickness":30,"line":{"color":"black","width":0.5},"x":[0,100,0,100,0,0,0,100,0,100,200,0,100,0,0,100,0,100,0,100,200,300,0,100,200,0,100,0,100,0,100,0,100,0,100,200,0,100,200,300,400,0,0,100,200,300,0,0,0,200,300,0,100],"label":["carboplatin,<br>peme...","docetaxel","erlotinib","osimertinib","crizotinib","cisplatin,<br>etopos...","carboplatin,<br>pacl...","gemcitabine","pemetrexed","pembrolizumab","cisplatin,<br>pemetr...","temozolomide","bevacizumab","carboplatin,<br>pacl...","carboplatin","carboplatin,<br>peme...","docetaxel","bevacizumab","nivolumab","fluorouracil","carboplatin,<br>peme...","nivolumab","ceritinib","alectinib","cisplatin,<br>fluoro...","gemcitabine","palbociclib","methotrexate","pertuzumab,<br>docet...","ado-trastuzumab emta...","capecitabine","hydroxyurea","letrozole","gemcitabine,<br>carb...","pemetrexed","alectinib"],"color":["#CF51E6","#50BF85","#64BE82","#0AD7DD","#F1CA43","#8B2EB9","#9282AC","#1AAC60","#3F1C9D","#3E44EF","#D1BBBA","#688B68","#87059F","#9282AC","#03D2F5","#CF51E6","#50BF85","#87059F","#7515F1","#B4DF3F","#CF51E6","#7515F1","#94E8F9","#462F09","#1C2B1C","#1AAC60","#ADD0D0","#375BFE","#50B8BC","#C62427","#75D3E4","#19AD6A","#E62D06","#BEEA37","#3F1C9D","#462F09"],"customdata":[{"incoming":0,"outgoing":3,"fullLabel":"carboplatin,<br>pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"docetaxel"},{"incoming":0,"outgoing":2,"fullLabel":"erlotinib"},{"incoming":1,"outgoing":2,"fullLabel":"osimertinib"},{"incoming":0,"outgoing":3,"fullLabel":"crizotinib"},{"incoming":0,"outgoing":4,"fullLabel":"cisplatin,<br>etoposide"},{"incoming":1,"outgoing":1,"fullLabel":"carboplatin,<br>paclitaxel"},{"incoming":2,"outgoing":3,"fullLabel":"gemcitabine"},{"incoming":2,"outgoing":1,"fullLabel":"pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"pembrolizumab"},{"incoming":0,"outgoing":1,"fullLabel":"cisplatin,<br>pemetrexed"},{"incoming":0,"outgoing":1,"fullLabel":"temozolomide"},{"incoming":1,"outgoing":1,"fullLabel":"bevacizumab"},{"incoming":0,"outgoing":3,"fullLabel":"carboplatin,<br>paclitaxel"},{"incoming":0,"outgoing":1,"fullLabel":"carboplatin"},{"incoming":1,"outgoing":1,"fullLabel":"carboplatin,<br>pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"docetaxel"},{"incoming":0,"outgoing":1,"fullLabel":"bevacizumab"},{"incoming":2,"outgoing":2,"fullLabel":"nivolumab"},{"incoming":1,"outgoing":1,"fullLabel":"fluorouracil"},{"incoming":1,"outgoing":1,"fullLabel":"carboplatin,<br>pemetrexed"},{"incoming":2,"outgoing":3,"fullLabel":"nivolumab"},{"incoming":1,"outgoing":1,"fullLabel":"ceritinib"},{"incoming":1,"outgoing":1,"fullLabel":"alectinib"},{"incoming":1,"outgoing":1,"fullLabel":"cisplatin,<br>fluorouracil"},{"incoming":2,"outgoing":2,"fullLabel":"gemcitabine"},{"incoming":1,"outgoing":1,"fullLabel":"palbociclib"},{"incoming":0,"outgoing":1,"fullLabel":"methotrexate"},{"incoming":0,"outgoing":1,"fullLabel":"pertuzumab,<br>docetaxel"},{"incoming":1,"outgoing":1,"fullLabel":"ado-trastuzumab emtansine"},{"incoming":1,"outgoing":1,"fullLabel":"capecitabine"},{"incoming":0,"outgoing":1,"fullLabel":"hydroxyurea"},{"incoming":0,"outgoing":1,"fullLabel":"letrozole"},{"incoming":0,"outgoing":1,"fullLabel":"gemcitabine,<br>carboplatin"},{"incoming":1,"outgoing":1,"fullLabel":"pemetrexed"},{"incoming":1,"outgoing":1,"fullLabel":"alectinib"}],"hovertemplate":"Node: %{customdata.fullLabel}<br>Patients: %{value}<br>Incoming Links: %{customdata.incoming}<br>Outgoing Links: %{customdata.outgoing}<extra></extra>"},"link":{"color":["rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(195,195,195,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(195,195,195,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(128,128,128,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(128,128,128,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(195,195,195,1)","rgba(55,55,55,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(73,73,73,1)","rgba(128,128,128,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)","rgba(55,55,55,1)","rgba(230,230,230,1)"],"source":[0,1,2,3,0,4,5,6,5,7,8,5,9,10,11,12,13,7,14,3,15,16,17,7,18,13,19,5,20,13,21,0,21,4,22,23,2,21,24,25,26,27,28,29,30,25,31,32,33,18,34,4,35],"target":[1,-1,3,-1,-1,-1,6,-1,7,8,-1,9,-1,-1,12,-1,7,-1,-1,15,16,-1,-1,18,-1,19,-1,20,18,21,8,21,-1,22,23,-1,-1,24,25,26,-1,-1,29,30,25,-1,-1,-1,-1,34,-1,35,-1],"value":[2,2,7,6,7,1,2,2,2,1,2,1,1,1,1,1,3,2,2,1,1,1,1,2,2,1,1,1,1,2,1,2,2,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1],"label":["Duration to next treatment median: No Change<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 4 months, <extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 9 months, 4 days<br>Duration to next treatment maximum: 1 year, 7 months, 4 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 month, 1 day<br>Duration to next treatment minimum: 1 month, <br>Duration to next treatment maximum: 2 years, 1 month, 2 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 3 months, 2 days<br>Duration to next treatment maximum: 7 months, 4 days<extra></extra>","Duration to next treatment median: 6 months, 3 days<br>Duration to next treatment minimum: 6 months, 3 days<br>Duration to next treatment maximum: 6 months, 3 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 8 months, 2 days<br>Duration to next treatment minimum: 8 months, 2 days<br>Duration to next treatment maximum: 8 months, 2 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 6 months, 1 day<br>Duration to next treatment minimum: 6 months, 1 day<br>Duration to next treatment maximum: 6 months, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 2 months, 1 day<br>Duration to next treatment maximum: 2 months, 29 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 5 months, 3 days<br>Duration to next treatment minimum: 5 months, 3 days<br>Duration to next treatment maximum: 5 months, 3 days<extra></extra>","Duration to next treatment median: 1 year, 1 month, 1 day<br>Duration to next treatment minimum: 1 year, 1 month, 1 day<br>Duration to next treatment maximum: 1 year, 1 month, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 7 months, 4 days<br>Duration to next treatment maximum: 9 months, 3 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 years, 10 months, 4 days<br>Duration to next treatment minimum: 2 years, 10 months, 4 days<br>Duration to next treatment maximum: 2 years, 10 months, 4 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 year, 2 months, 2 days<br>Duration to next treatment minimum: 1 year, 2 months, 2 days<br>Duration to next treatment maximum: 1 year, 2 months, 2 days<extra></extra>","Duration to next treatment median: 11 months, 4 days<br>Duration to next treatment minimum: 11 months, 4 days<br>Duration to next treatment maximum: 11 months, 4 days<extra></extra>","Duration to next treatment median: 1 month, <br>Duration to next treatment minimum: 4 months, 1 day<br>Duration to next treatment maximum: 1 year, 7 months, 6 days<extra></extra>","Duration to next treatment median: 2 months, 29 days<br>Duration to next treatment minimum: 2 months, 29 days<br>Duration to next treatment maximum: 2 months, 29 days<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 9 months, 5 days<br>Duration to next treatment maximum: 1 year, 1 month, 29 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 year, 4 months, 3 days<br>Duration to next treatment minimum: 1 year, 4 months, 3 days<br>Duration to next treatment maximum: 1 year, 4 months, 3 days<extra></extra>","Duration to next treatment median: 1 year, 4 months, 1 day<br>Duration to next treatment minimum: 1 year, 4 months, 1 day<br>Duration to next treatment maximum: 1 year, 4 months, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 months, 1 day<br>Duration to next treatment minimum: 2 months, 1 day<br>Duration to next treatment maximum: 2 months, 1 day<extra></extra>","Duration to next treatment median: 11 months, 4 days<br>Duration to next treatment minimum: 11 months, 4 days<br>Duration to next treatment maximum: 11 months, 4 days<extra></extra>","Duration to next treatment median: 9 months, 6 days<br>Duration to next treatment minimum: 9 months, 6 days<br>Duration to next treatment maximum: 9 months, 6 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 10 months, 5 days<br>Duration to next treatment minimum: 10 months, 5 days<br>Duration to next treatment maximum: 10 months, 5 days<extra></extra>","Duration to next treatment median: 6 months, 2 days<br>Duration to next treatment minimum: 6 months, 2 days<br>Duration to next treatment maximum: 6 months, 2 days<extra></extra>","Duration to next treatment median: 3 months, 1 day<br>Duration to next treatment minimum: 3 months, 1 day<br>Duration to next treatment maximum: 3 months, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 2 years, 8 months, 4 days<br>Duration to next treatment minimum: 2 years, 8 months, 4 days<br>Duration to next treatment maximum: 2 years, 8 months, 4 days<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>","Duration to next treatment median: 1 year, 3 months, 1 day<br>Duration to next treatment minimum: 1 year, 3 months, 1 day<br>Duration to next treatment maximum: 1 year, 3 months, 1 day<extra></extra>","Duration to next treatment median: No Change<br>Duration to next treatment minimum: No Change<br>Duration to next treatment maximum: No Change<extra></extra>"],"hovertemplate":"%{label}<extra></extra>"}}}]

    groups.forEach((group, i) => {
      if (!group?.data || !group?.layout) {
        return
      }
      const data = group.data
      const layout = group.layout
      
      if (data.node.customdata.length <= 1) {
        layout.height = 200
      } else {
        layout.height = 600
      }

      const id = `PlotlyChart-${i}`
      
      // Create new div to mount chart to
      const graphDiv = document.createElement('div')
      graphDiv.id = id
      const parent = document.getElementById('sankey-graph')
      parent.appendChild(graphDiv)

      Plotly.react(id, [data], layout, { responsive: true, displayModeBar: false }).then(() => {
        // After rendering, manually replace <br> in labels with <tspan> because they aren't created
        // by Plotly when displayed this way.
        const svgTextNodes = graphDiv.querySelectorAll('.node-label')
        svgTextNodes.forEach((textNode) => {
          const originalText = textNode.textContent

          if (originalText.includes('<br>')) {
            const lines = originalText.split('<br>')
            textNode.innerHTML = ''

            lines.forEach((line, index) => {
              // Have to use createElementNS to create a tspan. Can't use createElement.
              // https://www.motiontricks.com/creating-dynamic-svg-elements-with-javascript/
              const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan')
              // These are the attributes Plotly adds to its tspans when given <br> Datma.Why
              tspan.setAttribute('x', '0')
              tspan.setAttribute('dy', index === 0 ? '0em' : '1.3em')
              tspan.textContent = line
              textNode.appendChild(tspan)
            })
          }
        })
      })
    })
  </script>
</body>
</html>